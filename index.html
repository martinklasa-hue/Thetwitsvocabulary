<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vocabulary Trainer – The Twits</title>
  <style>
    :root { --bg:#0b1220; --card:#1e293b; --ink:#f1f5f9; --muted:#9fb0c9; --edge:#334155; --accent:#38bdf8; --good:#22c55e; --bad:#ef4444; }
    *{box-sizing:border-box}
    body { font-family: system-ui, sans-serif; background: var(--bg); color: var(--ink); margin: 0; padding: 1.5rem; line-height: 1.5; }
    h1 { color: var(--accent); margin-bottom: .25rem; }
    .sub{color:var(--muted); margin:0 0 1rem}
    .section { background: var(--card); border: 1px solid var(--edge); border-radius: 10px; padding: 1rem; margin-bottom: 1rem; }
    .row{display:grid; gap:12px}
    @media(min-width:900px){ .row{ grid-template-columns:1fr 1fr; } }
    select, input, button { width: 100%; border-radius: 8px; border: 1px solid var(--edge); background: #0f172a; color: white; padding: .6rem .75rem; font-size: 1rem; }
    button { background: var(--accent); color: #081323; border: none; font-weight: 800; cursor: pointer; }
    button.ghost{ background: transparent; border:1px solid var(--edge); color: var(--ink); }
    .flash { font-size: 1.35rem; background: #0f172a; border: 1px dashed var(--edge); border-radius: 10px; text-align: center; padding: 2rem 1rem; min-height: 120px; margin-bottom: .5rem; }
    .feedback { margin-top: .5rem; font-weight: bold; }
    .ok { color: var(--good); }
    .bad { color: var(--bad); }
    .bar{display:flex; gap:8px; flex-wrap:wrap}
    .muted{color:var(--muted); font-size:.9rem}
    .hide{display:none}
  </style>
</head>
<body>
  <h1>Vocabulary Trainer – The Twits</h1>
  <p class="sub">Välj en ordlista, träna först med <strong>flashcards</strong> och testa sedan att <strong>skriva orden</strong>. Allt sparas lokalt i din webbläsare.</p>

  <div class="section">
    <label for="listSelect">Välj ordlista:</label>
    <select id="listSelect"></select>
    <div class="bar" style="margin-top:8px">
      <button id="startFlash">Starta Flashcards</button>
      <button id="startPractice" class="ghost">Starta Skrivtest</button>
    </div>
    <p class="muted" id="progressText"></p>
  </div>

  <!-- FLASHCARDS -------------------------------------------------------->
  <div class="section hide" id="flashView">
    <h3>Flashcards</h3>
    <div class="flash" id="flashCard">—</div>
    <div class="bar">
      <button id="revealBtn">Visa betydelsen</button>
      <button id="againBtn" class="ghost">Se igen</button>
      <button id="gotBtn">Jag kunde den</button>
    </div>
    <p class="muted">Tips: När du gått igenom alla kort kan du gå vidare till skrivtest.</p>
    <div class="bar" style="margin-top:8px">
      <button id="toPractice" class="ghost">Gå till Skrivtest</button>
    </div>
  </div>

  <!-- PRACTICE (skriva orden) ------------------------------------------>
  <div class="section hide" id="practiceView">
    <h3>Skriv test – Skriv det engelska ordet</h3>
    <p class="muted">Du får den svenska betydelsen. Skriv det <em>engelska</em> ordet.</p>
    <div class="flash" id="pPrompt">—</div>
    <input id="pAnswer" placeholder="Skriv det engelska ordet…" />
    <div class="bar" style="margin-top:8px">
      <button id="pCheck">Kolla</button>
      <button id="pSkip" class="ghost">Hoppa över</button>
    </div>
    <div id="pFeedback" class="feedback"></div>
  </div>

  <script>
    // -------------------------------------------------- Data
    const WORD_LISTS = {
      "The Twits 1": [
        { term: "shrunk", definition: "became smaller in size – krympte" },
        { term: "dangling", definition: "hanging loosely – hängande" },
        { term: "terrible", definition: "very bad or unpleasant – hemsk" },
        { term: "disease", definition: "illness or sickness – sjukdom" },
        { term: "bundle", definition: "a group of things tied or wrapped together – knyte, bunt" },
        { term: "solemn", definition: "serious and dignified – högtidlig, allvarlig" },
        { term: "cure", definition: "make someone healthy again – bota" },
        { term: "clutching", definition: "holding tightly – hålla hårt i, klamra sig fast" }
      ],
      "The Twits 2": [
        { term: "neatly", definition: "tidily or carefully – prydligt" },
        { term: "gradually", definition: "slowly over time – gradvis" },
        { term: "notice", definition: "to become aware of – lägga märke till" },
        { term: "enjoy", definition: "to take pleasure in – njuta av" },
        { term: "suddenly", definition: "quickly and unexpectedly – plötsligt" },
        { term: "grinning", definition: "smiling widely – flinande" },
        { term: "horribly", definition: "in a terrible or awful way – hemskt" },
        { term: "goat", definition: "an animal with horns – get" },
        { term: "comparison", definition: "examining similarities and differences – jämförelse" },
        { term: "trembly", definition: "shaking slightly – darrig" }
      ]
    };

    // -------------------------------------------------- Helpers
    const $ = (id)=>document.getElementById(id);
    const listSelect = $('listSelect');
    const progressText = $('progressText');

    Object.keys(WORD_LISTS).forEach(name=>{
      const opt=document.createElement('option'); opt.value=name; opt.textContent=name; listSelect.appendChild(opt);
    });

    function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
    function keyProgress(list){ return `vocab:progress:${list}`; }
    function loadProgress(list){ try{ return JSON.parse(localStorage.getItem(keyProgress(list)))||{flash:{known:0,total:WORD_LISTS[list].length}, practice:{correct:0,wrong:0}} }catch{ return {flash:{known:0,total:WORD_LISTS[list].length}, practice:{correct:0,wrong:0}} }
    }
    function saveProgress(list, obj){ localStorage.setItem(keyProgress(list), JSON.stringify(obj)); }
    function show(el){ el.classList.remove('hide'); }
    function hide(el){ el.classList.add('hide'); }

    // -------------------------------------------------- State
    let currentListName = Object.keys(WORD_LISTS)[0];
    let flashQueue = []; let flashIdx = 0; let showingDef=false;
    let practiceQueue = []; let currentP=null; let prog=null;

    listSelect.addEventListener('change',()=>{ currentListName=listSelect.value; updateKpis(); });

    function updateKpis(){
      prog = loadProgress(currentListName);
      progressText.textContent = `Flashcards kända: ${prog.flash.known}/${prog.flash.total}  •  Skrivtest: ✔ ${prog.practice.correct} / ✖ ${prog.practice.wrong}`;
      saveProgress(currentListName, prog);
    }

    // ------------------------------ Flashcards
    const flashView = $('flashView');
    const flashCard = $('flashCard');
    const revealBtn = $('revealBtn');
    const againBtn = $('againBtn');
    const gotBtn = $('gotBtn');
    const toPractice = $('toPractice');

    $('startFlash').addEventListener('click', ()=>{
      currentListName = listSelect.value; prog = loadProgress(currentListName);
      flashQueue = shuffle([...WORD_LISTS[currentListName]]);
      flashIdx=0; showingDef=false;
      hide($('practiceView')); show(flashView); renderFlash(); updateKpis();
    });

    function renderFlash(){
      const item = flashQueue[flashIdx];
      if(!item){ flashCard.textContent='Klar med flashcards! Bra jobbat.'; return; }
      flashCard.innerHTML = showingDef
        ? `<div><strong>${item.term}</strong><br/><span style="color:#c7d2fe">${item.definition}</span></div>`
        : `<div><strong>${item.term}</strong></div>`;
    }

    revealBtn.addEventListener('click',()=>{ showingDef=!showingDef; renderFlash(); });
    againBtn.addEventListener('click',()=>{ if(!flashQueue[flashIdx]) return; // send current to end
      flashQueue.push(flashQueue[flashIdx]); flashIdx++; showingDef=false; renderFlash(); });
    gotBtn.addEventListener('click',()=>{ if(!flashQueue[flashIdx]) return; flashIdx++; showingDef=false; prog.flash.known=Math.min(prog.flash.total, (prog.flash.known||0)+1); saveProgress(currentListName,prog); renderFlash(); updateKpis(); });
    toPractice.addEventListener('click',()=>{ startPractice(); });

    // ------------------------------ Practice (skriv engelska ordet)
    const practiceView = $('practiceView');
    const pPrompt = $('pPrompt');
    const pAnswer = $('pAnswer');
    const pFeedback = $('pFeedback');

    $('startPractice').addEventListener('click', startPractice);

    function startPractice(){
      currentListName = listSelect.value; prog = loadProgress(currentListName);
      practiceQueue = shuffle([...WORD_LISTS[currentListName]]);
      hide(flashView); show(practiceView); nextPractice(); updateKpis();
    }

    function swedishFromDef(def){
      const parts = def.split('–');
      return (parts[1]||parts[0]).trim();
    }

    function nextPractice(){
      if(!practiceQueue.length){ pPrompt.textContent='Klar! Du har gjort skrivtestet för denna lista.'; pFeedback.textContent=''; return; }
      currentP = practiceQueue.shift();
      pPrompt.textContent = swedishFromDef(currentP.definition);
      pAnswer.value=''; pFeedback.textContent=''; pAnswer.focus();
    }

    $('pCheck').addEventListener('click', ()=>{
      if(!currentP) return;
      const ans = pAnswer.value.trim().toLowerCase();
      const correct = currentP.term.toLowerCase();
      if(ans && ans === correct){
        pFeedback.innerHTML = `<span class='ok'>✔ Rätt!</span> ${currentP.term} – ${currentP.definition}`;
        prog.practice.correct = (prog.practice.correct||0)+1;
      } else {
        pFeedback.innerHTML = `<span class='bad'>✖ Fel.</span> Rätt svar: <strong>${currentP.term}</strong> – ${currentP.definition}`;
        prog.practice.wrong = (prog.practice.wrong||0)+1;
      }
      saveProgress(currentListName, prog);
      updateKpis();
      setTimeout(nextPractice, 800);
    });

    $('pSkip').addEventListener('click', ()=>{ if(!currentP) return; practiceQueue.push(currentP); nextPractice(); });

    // Init
    listSelect.value = currentListName; updateKpis();
  </script>
</body>
</html>

